<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sangue e Lacrime | Studio Booking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --sage: #a3b18a; --cream: #f4f1ea; }
        body { font-family: 'Inter', sans-serif; background-color: var(--cream); color: #2d3436; overflow-x: hidden; }
        .serif { font-family: 'Playfair Display', serif; }
        .step { display: none; }
        .step.active { display: block; animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(10px); } to { opacity: 1; transform: translateX(0); } }
        .progress-bar { transition: width 0.4s ease; background-color: var(--sage); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center py-10 px-4">

    <div class="max-w-md w-full bg-white rounded-[2.5rem] shadow-2xl overflow-hidden min-h-[600px] flex flex-col">
        <div class="w-full h-1.5 bg-stone-100"><div id="progress" class="progress-bar h-full w-1/4"></div></div>

        <div class="bg-[#a3b18a] p-8 text-white text-center">
            <h1 class="serif text-2xl tracking-widest uppercase">Sangue e Lacrime</h1>
            <p id="stepTitle" class="text-[9px] uppercase tracking-[0.2em] mt-1 opacity-80 font-semibold">Passo 1: Servizio</p>
        </div>

        <form id="tattooForm" class="p-8 flex-grow flex flex-col justify-between">
            
            <div class="step active" id="step1">
                <label class="text-[10px] uppercase font-bold text-stone-400 mb-4 block tracking-widest">Cosa desideri fare?</label>
                <div class="flex p-1 bg-stone-100 rounded-2xl mb-6">
                    <button type="button" onclick="setService('Preventivo', this)" class="service-btn flex-1 py-3 text-[10px] font-bold uppercase rounded-xl bg-white shadow-sm transition-all">ü™µ Preventivo</button>
                    <button type="button" onclick="setService('Prenotazione', this)" class="service-btn flex-1 py-3 text-[10px] font-bold uppercase rounded-xl transition-all">üìÖ Prenota</button>
                    <input type="hidden" id="tipoServizio" value="Preventivo">
                </div>
                <label class="text-[10px] uppercase font-bold text-stone-400 mb-2 block tracking-widest">Scegli lo Stile</label>
                <select id="stile" class="w-full p-4 bg-stone-50 border border-stone-100 rounded-xl outline-none text-sm appearance-none cursor-pointer">
                    <option value="Botanico / Fine-line">üåø Botanico / Fine-line</option>
                    <option value="Minimalista">‚ú® Minimalista</option>
                    <option value="Tradizionale">‚öì Tradizionale</option>
                    <option value="Blackwork / Dark">üñ§ Blackwork / Dark</option>
                    <option value="Lettering">‚úçÔ∏è Lettering</option>
                </select>
            </div>

            <div class="step" id="step2">
                <label class="text-[10px] uppercase font-bold text-stone-400 mb-2 block tracking-widest">Dettagli Tatuaggio</label>
                <textarea id="idea" placeholder="Soggetto e dettagli..." rows="2" class="w-full p-4 bg-stone-50 border border-stone-100 rounded-xl outline-none text-sm mb-3"></textarea>
                <div class="grid grid-cols-2 gap-3 mb-3">
                    <input type="text" id="pos" placeholder="Zona corpo" class="p-4 bg-stone-50 border border-stone-100 rounded-xl text-sm">
                    <input type="text" id="mis" placeholder="Misure cm" class="p-4 bg-stone-50 border border-stone-100 rounded-xl text-sm">
                </div>
                <label class="flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-stone-200 rounded-xl cursor-pointer bg-stone-50 hover:bg-stone-100 transition-all">
                    <span id="fotoStatus" class="text-[10px] uppercase font-bold text-stone-400 text-center px-2 text-center">üìé Allega Reference</span>
                    <input id="fotoInput" type="file" accept="image/*" class="hidden" onchange="uploadToCloudinary(this)" />
                </label>
            </div>

            <div class="step" id="step3">
                <label class="text-[10px] uppercase font-bold text-stone-400 mb-3 block tracking-widest">‚ö†Ô∏è Salute & Sicurezza</label>
                <div class="space-y-3 bg-stone-50 p-4 rounded-xl border border-stone-100 text-[11px]">
                    <div class="flex items-start gap-2"><input type="checkbox" id="c1" class="mt-1"><label for="c1">Niente alcol/droghe nelle ultime 24h</label></div>
                    <div class="flex items-start gap-2"><input type="checkbox" id="c2" class="mt-1"><label for="c2">Nessuna gravidanza/allattamento</label></div>
                    <div class="flex items-start gap-2"><input type="checkbox" id="c3" class="mt-1"><label for="c3">Nessuna allergia grave/patologia pelle</label></div>
                    <div class="flex items-start gap-2"><input type="checkbox" id="c4" class="mt-1"><label for="c4">Sono maggiorenne (+18)</label></div>
                </div>
            </div>

            <div class="step" id="step4">
                <input type="text" id="nome" placeholder="Nome e Cognome" required class="w-full p-4 bg-stone-50 border border-stone-100 rounded-xl text-sm mb-3">
                <input type="text" id="ig" placeholder="Profilo Instagram" class="w-full p-4 bg-stone-50 border border-stone-100 rounded-xl text-sm mb-3">
                <input type="text" id="date" placeholder="Disponibilit√† (giorni/orari)" class="w-full p-4 bg-stone-50 border border-stone-100 rounded-xl text-sm">
            </div>

            <div class="mt-8 flex gap-3">
                <button type="button" id="prevBtn" onclick="changeStep(-1)" class="hidden flex-1 py-4 border border-stone-200 rounded-2xl text-[10px] font-bold uppercase tracking-widest transition-all">Indietro</button>
                <button type="button" id="nextBtn" onclick="changeStep(1)" class="flex-[2] py-4 bg-[#a3b18a] text-white rounded-2xl text-[10px] font-bold uppercase tracking-widest shadow-lg">Avanti</button>
            </div>
        </form>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 4;
        let imageUrl = "Nessuna foto";

        // --- CONFIGURA QUI ---
        const CLOUD_NAME = "dmzxzjy3b";
        const UPLOAD_PRESET = "qwonr5tg";
        const MIO_NUMERO = "3474184010";
        // ----------------------

        function setService(val, btn) {
            document.getElementById('tipoServizio').value = val;
            document.querySelectorAll('.service-btn').forEach(b => b.classList.remove('bg-white', 'shadow-sm'));
            btn.classList.add('bg-white', 'shadow-sm');
        }

        async function uploadToCloudinary(input) {
            if (!input.files || !input.files[0]) return;
            const status = document.getElementById('fotoStatus');
            status.innerText = "CARICAMENTO... ‚è≥";
            
            const formData = new FormData();
            formData.append("file", input.files[0]);
            formData.append("upload_preset", UPLOAD_PRESET);

            try {
                const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, { method: "POST", body: formData });
                const data = await res.json();
                if (data.secure_url) {
                    imageUrl = data.secure_url;
                    status.innerText = "‚úÖ FOTO CARICATA CORRETTAMENTE";
                    status.style.color = "#a3b18a";
                }
            } catch (err) { status.innerText = "‚ùå ERRORE CARICAMENTO"; }
        }

        function changeStep(n) {
            if (n === 1 && currentStep === 3) {
                if (!document.getElementById('c1').checked || !document.getElementById('c2').checked || !document.getElementById('c3').checked || !document.getElementById('c4').checked) {
                    alert("‚ö†Ô∏è Conferma tutti i requisiti di salute per proseguire."); return;
                }
            }
            if (n === 1 && currentStep === 4) { sendWhatsApp(); return; }

            document.querySelectorAll('.step')[currentStep-1].classList.remove('active');
            currentStep += n;
            document.querySelectorAll('.step')[currentStep-1].classList.add('active');
            updateUI();
        }

        function updateUI() {
            document.getElementById('progress').style.width = (currentStep / totalSteps * 100) + "%";
            document.getElementById('prevBtn').classList.toggle('hidden', currentStep === 1);
            document.getElementById('nextBtn').innerText = currentStep === totalSteps ? "INVIA A LUIGI üåø" : "AVANTI";
            const titles = ["Servizio", "Progetto", "Salute", "Contatti"];
            document.getElementById('stepTitle').innerText = `Passo ${currentStep}: ${titles[currentStep-1]}`;
        }

        function sendWhatsApp() {
            const msg = `üåø *SANGUE E LACRIME | BOOKING*%0A` +
                        `--------------------------%0A` +
                        `üî• *Richiesta:* ${document.getElementById('tipoServizio').value}%0A` +
                        `üé® *Stile:* ${document.getElementById('stile').value}%0A` +
                        `üìù *Idea:* ${document.getElementById('idea').value}%0A` +
                        `üìç *Zona:* ${document.getElementById('pos').value} (${document.getElementById('mis').value})%0A` +
                        `üñºÔ∏è *Reference:* ${imageUrl}%0A` +
                        `üë§ *Cliente:* ${document.getElementById('nome').value}%0A` +
                        `üì∏ *IG:* ${document.getElementById('ig').value}%0A` +
                        `üìÖ *Dispo:* ${document.getElementById('date').value}`;
            window.location.href = `https://api.whatsapp.com/send?phone=${MIO_NUMERO}&text=${msg}`;
        }
    </script>
</body>
</html>
